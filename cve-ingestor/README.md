# CVE Ingestor Service

Microservice that ingests CVE data from public feeds (NVD, CISA KEV, OSV) and stores embeddings in Pinecone.

## Features

- Fetches from NVD CVE 2.0 API with pagination and rate limiting
- Fetches from CISA Known Exploited Vulnerabilities catalog
- Optional OSV.dev API integration (feature flag)
- Normalizes all sources to a common schema
- Chunks, embeds (via Ollama), and upserts to Pinecone
- Background scheduler for automatic refresh (every 6 hours)
- Manual refresh endpoint

## Endpoints

- `GET /health` - Health check
- `GET /stats` - Get ingestion stats per namespace
- `POST /refresh` - Manually trigger refresh

## Environment Variables

- `NVD_API_BASE` - NVD API base URL (default: https://services.nvd.nist.gov/rest/json/cves/2.0)
- `NVD_API_KEY` - Optional NVD API key for higher rate limits
- `CISA_KEV_JSON` - CISA KEV JSON feed URL
- `OSV_API_BASE` - OSV API base URL
- `OSV_ENABLED` - Enable OSV integration (default: false)
- `CVE_REFRESH_WINDOW_DAYS` - Days to look back for NVD (default: 3)
- `CVE_AUTORUN` - Enable background scheduler (default: false)
- `OLLAMA_URL` - Ollama service URL
- `EMBED_MODEL` - Embedding model name
- `PINECONE_API_KEY` - Pinecone API key
- `PINECONE_INDEX` - Pinecone index name
- `SENTRY_DSN` - Optional Sentry DSN for error logging
- `APP_ENV` - Application environment
- `GIT_SHA` - Git commit SHA for release tracking

## Namespaces

- `nvd` - NVD CVE data
- `cisa_kev` - CISA Known Exploited Vulnerabilities
- `osv` - OSV.dev data (if enabled)

